<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Export - Agriculture Data Collection</title>
    <link rel="stylesheet" href="dashboard.css">
    <style>
        .export-container {
            margin-top: 60px;
            padding: 30px;
            max-width: 1400px;
            margin-left: auto;
            margin-right: auto;
        }

        .export-header {
            margin-bottom: 30px;
        }

        .export-header h1 {
            font-size: 28px;
            color: #333;
            margin: 0 0 10px 0;
        }

        .export-description {
            color: #666;
            line-height: 1.6;
            margin-bottom: 30px;
        }

        .export-layout {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        .export-section {
            background: white;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .export-section h2 {
            font-size: 20px;
            color: #333;
            margin: 0 0 20px 0;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .form-group label .required {
            color: #dc3545;
        }

        .form-group select,
        .form-group input {
            width: 100%;
            padding: 10px 12px;
            font-size: 14px;
            border: 1px solid #ced4da;
            border-radius: 4px;
        }

        .form-group select:focus,
        .form-group input:focus {
            outline: none;
            border-color: #80bdff;
            box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
        }

        .form-group select:disabled {
            background: repeating-linear-gradient(
                45deg,
                #f8f9fa,
                #f8f9fa 10px,
                #e9ecef 10px,
                #e9ecef 20px
            );
            cursor: not-allowed;
        }

        .form-actions {
            display: flex;
            gap: 10px;
            margin-top: 25px;
        }

        .btn-add-queue {
            padding: 10px 24px;
            background: #28a745;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .btn-add-queue:hover {
            background: #218838;
        }

        .btn-cancel {
            padding: 10px 24px;
            background: white;
            color: #6c757d;
            border: 1px solid #6c757d;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .btn-cancel:hover {
            background: #f8f9fa;
        }

        .export-list {
            margin-top: 20px;
        }

        .export-item {
            padding: 20px;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            margin-bottom: 15px;
            background: #f8f9fa;
        }

        .export-item-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 10px;
        }

        .export-number {
            font-size: 14px;
            color: #999;
            font-weight: 600;
        }

        .export-title {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            flex: 1;
        }

        .export-meta {
            font-size: 13px;
            color: #666;
            margin-bottom: 8px;
        }

        .export-meta strong {
            color: #333;
        }

        .export-status {
            padding: 15px;
            background: white;
            border-left: 4px solid #28a745;
            border-radius: 4px;
            margin-bottom: 10px;
        }

        .export-status.in-queue {
            border-left-color: #ffc107;
        }

        .export-status-text {
            font-size: 14px;
            color: #666;
            margin-bottom: 5px;
        }

        .export-progress {
            font-size: 13px;
            color: #666;
        }

        .btn-download {
            padding: 8px 20px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
        }

        .btn-download:hover {
            background: #0056b3;
        }

        .export-file-info {
            font-size: 12px;
            color: #999;
            margin-top: 5px;
        }

        .empty-state {
            text-align: center;
            padding: 40px;
            color: #999;
        }

        .empty-state h3 {
            font-size: 18px;
            margin-bottom: 10px;
        }

        .empty-state p {
            font-size: 14px;
        }

        .export-icon {
            font-size: 40px;
            margin-bottom: 10px;
        }

        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            font-size: 11px;
            font-weight: 600;
            border-radius: 12px;
            text-transform: uppercase;
        }

        .status-completed {
            background: #d4edda;
            color: #155724;
        }

        .status-in-queue {
            background: #fff3cd;
            color: #856404;
        }

        .status-processing {
            background: #d1ecf1;
            color: #0c5460;
        }

        @media (max-width: 1200px) {
            .export-layout {
                grid-template-columns: 1fr;
            }
        }

        .alert {
            padding: 12px 20px;
            border-radius: 4px;
            margin-bottom: 20px;
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .alert-info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-brand">
            <img src="../assets/logo.png" alt="Logo" class="nav-logo" onerror="this.style.display='none'">
            <span class="nav-title">Agriculture Data Collection</span>
        </div>
        <ul class="nav-menu">
            <li><a href="dashboard.html">Dashboard</a></li>
            <li><a href="workspaces.html">Workspaces</a></li>
            <li><a href="reports.html">Reports</a></li>
            <li><a href="interviews.html">Interviews</a></li>
            <li><a href="surveys.html">Surveys</a></li>
            <li><a href="data-export.html" class="active">Data Export</a></li>
            <li><a href="users.html">Users</a></li>
            <li><a href="../designer/index.html">Form Designer</a></li>
            <li><a href="settings.html">Settings</a></li>
        </ul>
        <div class="nav-user">
            <span id="userName">Admin</span>
            <button onclick="logout()" class="btn-logout">Logout</button>
        </div>
    </nav>

    <div class="export-container">
        <div class="export-header">
            <h1>Data Export</h1>
            <p class="export-description">
                Pressing Generate button creates a data archive of interviews available on the server at that time. 
                The time of archive creation and the archive size are shown in the table. The last generated data archive 
                can be downloaded by pressing Download button. Press Generate button again to create a new archive.
            </p>
        </div>

        <div class="export-layout">
            <!-- Left Column: Filter interviews to export -->
            <div class="export-section">
                <h2>Filter interviews to export</h2>

                <div id="exportAlert" style="display: none;"></div>

                <form id="exportForm">
                    <div class="form-group">
                        <label>
                            Questionnaire <span class="required">*</span>
                        </label>
                        <select id="questionnaire" required>
                            <option value="">All questionnaires</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>
                            Questionnaire version <span class="required">*</span>
                        </label>
                        <select id="version" disabled>
                            <option value="">Select</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Status of exported interviews</label>
                        <select id="status">
                            <option value="">All statuses</option>
                            <option value="supervisor_assigned">Supervisor Assigned</option>
                            <option value="interviewer_assigned">Interviewer Assigned</option>
                            <option value="completed">Completed</option>
                            <option value="rejected_supervisor">Rejected by Supervisor</option>
                            <option value="approved_supervisor">Approved by Supervisor</option>
                            <option value="rejected_hq">Rejected by HQ</option>
                            <option value="approved_hq">Approved by HQ</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Date range</label>
                        <input type="text" id="dateRange" placeholder="All time" readonly 
                               value="All time" 
                               style="cursor: pointer;">
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn-add-queue">ADD TO QUEUE</button>
                        <button type="button" class="btn-cancel" onclick="resetForm()">CANCEL</button>
                    </div>
                </form>
            </div>

            <!-- Right Column: Previously generated export sets -->
            <div class="export-section">
                <h2>Previously generated export sets</h2>
                <p style="color: #666; font-size: 13px; margin-bottom: 20px;">
                    Data is exported in a zip archive containing the data files of specified content and type. 
                    Below is a list of previously exported data.
                </p>

                <div class="export-list" id="exportList">
                    <div class="empty-state">
                        <div class="export-icon">ðŸ“¦</div>
                        <h3>No exports yet</h3>
                        <p>Use the form on the left to create your first data export</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="data-export.js"></script>
</body>
</html>
